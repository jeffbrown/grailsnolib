<project name="grails-bundle">

	<target name="jar" depends="build-test" description="Build the entire source, run all tests and create the Grails JAR file.">
		<delete>
			<fileset dir="${grails.dist}" includes="*"/>
		</delete>        
		<mkdir dir="${grails.build}/core/META-INF"  />
		  <manifest file="${grails.build}/core/META-INF/MANIFEST.MF">
		    <attribute name="Built-By" value="${user.name}"/>
		    <section name="common">
		      <attribute name="Implementation-Title" value="Grails"/>
		      <attribute name="Implementation-Version" value="${grailsVersion}"/> 
		      <attribute name="Implementation-Vendor" value="grails.org"/>
		      <attribute name="Date-Created" value="${TODAY}"/>    		
		    </section>
		  </manifest>		
		<jar destfile="${grails.dist}/grails-core-${grails.version}.jar" basedir="${grails.build}/core"/>
		<jar destfile="${grails.dist}/grails-gorm-${grails.version}.jar" basedir="${grails.build}/gorm"/>		
		<jar destfile="${grails.dist}/grails-web-${grails.version}.jar" basedir="${grails.build}/web"/>		
		<jar destfile="${grails.dist}/grails-crud-${grails.version}.jar" basedir="${grails.build}/crud"/>		
	</target>

    <target name="package" depends="clean,test,jar,javadoc" description="Create the release archives for Grails.">
    	<delete>
		  <fileset dir="${grails.dist}">
		  		<include name="*.zip"/>
     	  		<include name="*.tar.gz"/>
		  </fileset>
		</delete>
        <delete  file="${grails.dist}/${archive}.zip" failonerror="true"/>
        <delete file="${grails.dist}/${archive}.tar.gz" failonerror="true"/>
        <delete dir="tmp" failonerror="true"/>
        <antcall target="create-binary-release"/>
        <antcall target="create-source-release"/>
    </target>

</project>